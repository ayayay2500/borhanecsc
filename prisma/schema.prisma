model GiftCode {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  code        String     @unique
  points      Int        // عدد النقاط التي يمنحها الكود
  maxUses     Int        @default(1) // أقصى عدد للمستخدمين الذين يمكنهم استخدامه
  currentUses Int        @default(0) // كم مرة استُخدم حتى الآن
  createdAt   DateTime   @default(now())
  usedBy      UsedCode[]
}

model UsedCode {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  userId     Int      // تليجرام آيدي للمستخدم
  codeId     String   @db.ObjectId
  usedAt     DateTime @default(now())
  giftCode   GiftCode @relation(fields: [codeId], references: [id])

  @@unique([userId, codeId]) // يمنع نفس المستخدم من استخدام نفس الكود مرتين
}
